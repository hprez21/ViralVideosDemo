<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="ViralVideosDemo.Pages.VideoDisplayPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:vm="clr-namespace:ViralVideosDemo.ViewModels"
             x:DataType="vm:VideoDisplayViewModel"
             Title="Generated Video">
    
    <ScrollView>
        <StackLayout Padding="20" Spacing="15">
            
            <!--  Loading Indicator  -->
            <StackLayout IsVisible="{Binding IsLoading}" 
                         Padding="30"
                         HorizontalOptions="Center" 
                         VerticalOptions="Center"
                         Spacing="20">
                
                <ActivityIndicator IsRunning="{Binding IsLoading}" 
                                   Color="{StaticResource Primary}"
                                   HeightRequest="50"
                                   WidthRequest="50"
                                   HorizontalOptions="Center" />
                
                <Label Text="Loading your generated video..." 
                       FontSize="18" 
                       FontAttributes="Bold" 
                       HorizontalOptions="Center" 
                       TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource Primary}}" />
                
                <Label Text="Please wait while we prepare your video for playback" 
                       FontSize="14" 
                       HorizontalOptions="Center" 
                       TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray400}}" />
                
            </StackLayout>
            
            <!--  Main Content (hidden while loading)  -->
            <StackLayout IsVisible="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}" 
                         Spacing="15">
            
            <!-- Video Title -->
            <Label Text="{Binding VideoTitle}" 
                   FontSize="18" 
                   FontAttributes="Bold" 
                   HorizontalOptions="Center" 
                   TextColor="White"/>
            
            <!-- MediaElement for video playback -->
            <Border BackgroundColor="Black" 
                    StrokeThickness="2" 
                    Stroke="Gray"
                    Padding="5">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="10"/>
                </Border.StrokeShape>
                
                <toolkit:MediaElement x:Name="VideoPlayer"
                                    Source="{Binding VideoSource}"
                                    Aspect="AspectFit"
                                    ShouldShowPlaybackControls="True"
                                    ShouldAutoPlay="False"
                                    ShouldLoopPlayback="False"
                                    HeightRequest="300"
                                    BackgroundColor="Black"/>
            </Border>
            
            <!-- Video Controls -->
            <StackLayout Orientation="Horizontal" 
                         HorizontalOptions="Center" 
                         Spacing="20">
                <Button Text="Play" 
                        Command="{Binding PlayCommand}"
                        BackgroundColor="#1E90FF"
                        TextColor="White"
                        WidthRequest="80"/>
                <Button Text="Pause" 
                        Command="{Binding PauseCommand}"
                        BackgroundColor="#FF4500"
                        TextColor="White"
                        WidthRequest="80"/>
                <Button Text="Stop" 
                        Command="{Binding StopCommand}"
                        BackgroundColor="#DC143C"
                        TextColor="White"
                        WidthRequest="80"/>
            </StackLayout>
            
            <!-- Video Information -->
            <Frame BackgroundColor="#2C2C2C" 
                   BorderColor="Gray" 
                   CornerRadius="10" 
                   Padding="15">
                <StackLayout Spacing="10">
                    <Label Text="Video Information" 
                           FontSize="16" 
                           FontAttributes="Bold" 
                           TextColor="White"/>
                    
                    <Label Text="{Binding VideoDescription}" 
                           FontSize="14" 
                           TextColor="LightGray"
                           LineBreakMode="WordWrap"/>
                    
                    <Label Text="{Binding VideoDuration, StringFormat='Duration: {0}'}" 
                           FontSize="12" 
                           TextColor="LightGray"/>
                    
                    <Label Text="{Binding VideoStatus, StringFormat='Status: {0}'}" 
                           FontSize="12" 
                           TextColor="LightGray"/>
                </StackLayout>
            </Frame>
            
            <!-- Original Prompt Section -->
            <Frame BackgroundColor="#2C2C2C" 
                   BorderColor="Gray" 
                   CornerRadius="10" 
                   Padding="15">
                <StackLayout Spacing="10">
                    <Label Text="Original Prompt" 
                           FontSize="16" 
                           FontAttributes="Bold" 
                           TextColor="White"/>
                    
                    <Label Text="{Binding OriginalPrompt}" 
                           FontSize="14" 
                           TextColor="LightGray"
                           LineBreakMode="WordWrap"/>
                </StackLayout>
            </Frame>
            
            <!-- Enhanced Prompt Section (if available) -->
            <Frame BackgroundColor="#2C2C2C" 
                   BorderColor="Gray" 
                   CornerRadius="10" 
                   Padding="15"
                   IsVisible="{Binding HasEnhancedPrompt}">
                <StackLayout Spacing="10">
                    <Label Text="AI Enhanced Prompt" 
                           FontSize="16" 
                           FontAttributes="Bold" 
                           TextColor="White"/>
                    
                    <Label Text="{Binding EnhancedPrompt}" 
                           FontSize="14" 
                           TextColor="LightGray"
                           LineBreakMode="WordWrap"/>
                </StackLayout>
            </Frame>
            
            <!-- English Content Section -->
            <Frame BackgroundColor="#2C2C2C" 
                   BorderColor="Gray" 
                   CornerRadius="10" 
                   Padding="15">
                <StackLayout Spacing="10">
                    <Label Text="English Content" 
                           FontSize="16" 
                           FontAttributes="Bold" 
                           TextColor="White"/>
                    
                    <Label Text="{Binding EnglishContent}" 
                           FontSize="14" 
                           TextColor="LightGray"
                           LineBreakMode="WordWrap"/>
                </StackLayout>
            </Frame>
            
            <!-- Action Buttons -->
            <StackLayout Orientation="Horizontal" 
                         HorizontalOptions="Center" 
                         Spacing="15">
                <Button Text="Share Video" 
                        Command="{Binding ShareVideoCommand}"
                        BackgroundColor="#32CD32"
                        TextColor="White"
                        WidthRequest="120"/>
                <Button Text="Download" 
                        Command="{Binding DownloadCommand}"
                        BackgroundColor="#4169E1"
                        TextColor="White"
                        WidthRequest="120"/>
                <Button Text="Back" 
                        Command="{Binding BackCommand}"
                        BackgroundColor="#696969"
                        TextColor="White"
                        WidthRequest="120"/>
            </StackLayout>
            
            </StackLayout> <!-- Closing main content StackLayout -->
            
        </StackLayout>
    </ScrollView>
    
</ContentPage>
